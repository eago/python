(function(g){var h=window.AmazonUIPageJS||window.P,u=h._namespace||h.attributeErrors,e=u?u("DigitalVideoWebPlayerIntegration",""):h;e.guardFatal?e.guardFatal(g)(e,window):e.execute(function(){g(e,window)})})(function(g,h,u){g.when("logging","dv-web-player-cfg","dv-ajax-util").register("dv-player-load-src",function(e,d,b){var a=d.get("source"),f=e.create("dv-player-src"),k=d.get("retryTimeout")||1E3,x=d.get("retryAttempts")||3,t=0,p=function(c,a){var l=document.createElement("script");l.type="text/javascript";
l.crossOrigin="anonymous";l.readyState?l.onreadystatechange=function(){if("loaded"===l.readyState||"complete"===l.readyState)l.onreadystatechange=null,a()}:l.onload=function(){a()};l.src=c;l.onerror=r;l.async=!0;f.debug("loading web player source",c,l);document.getElementsByTagName("head")[0].appendChild(l)},r=function(){++t<=x?h.setTimeout(q,t*k):(h.ue&&"function"===typeof h.ue.count&&h.ue.count("DVWebPlayer:load:failure",1),h.navigator&&h.navigator.onLine&&f.fatal("Failed to load WebPlayer script after "+
t+" retries. SRC: "+a),b({url:"/gp/video/ajax/log-device-info.html/ref\x3datv_log_device_info",data:{description:"PlayerLoadFailed"}}))},m=function(){h.WebPlayer&&"function"===typeof h.WebPlayer?(f.debug("Webplayer Loaded succesfully",h.WebPlayer),g.register("dv-player-ready",function(){return new h.WebPlayer})):r()},q=function(){a&&p(a,m)};q();return{ready:function(c){g.when("dv-player-ready").execute(c)}}});"use strict";g.when("promise-polyfill","dv-player-load-src","dv-web-player-cfg","dv-player-default-view",
"dv-registry","dv-web-player-capabilities","logging").register("dv-player-integration",function(e,d,b,a,f,k,h){function g(){var c=b.get("playerConfig"),a={customerId:c.customerId,domElement:document.getElementById(c.domElementId),marketplaceId:c.marketplaceId,sessionId:c.sessionId,locale:c.locale};c.useBetaPlayer&&(a.playerBeta=c.useBetaPlayer);c.clientId&&(a.clientId=c.clientId);return a}function p(){return["initialized","closed","playing","pinRequired"]}function r(c){d.ready(function(a){a.on(c,
function(){m(c)})})}function m(c,a){l.debug("action called",c,a);for(var n=v.query(c),b=[],f=function(){d.ready(function(c){"function"===typeof a&&a(c)})},k=function(){l.debug("Promise failed",c,a)},h=0;h<n.length;h++){var g=n[h](w.getLastTitle());g&&"object"===typeof g&&"function"===typeof g.then&&b.push(g)}l.debug("callbacks registered for",c,b);b.length?1===b.length?e.resolve(b[0]).then(f,k):e.all(b).then(f,k):f()}function q(a){var b=a&&a.ref,n=function(n){n.play(g(),c(a),{clickstreamRefMarker:b})};
l.debug("play called",a);d.ready(function(){m("play",n)})}function c(c){c=c||{};var a={trailer:c.trailer||!1,useFullView:c.useFullView||!1,position:c.position||0,videoType:c.videoType};c.lcid?(a.asin=c.lcid,a.live=!0):c.asin&&(a.asin=c.asin);return a}function n(a){a=c(a);a.startEpoch=parseInt((new Date).getTime()/1E3,10);return a}var l=h.create("dv-player-integration"),v=f(),w=function(){var c=[];return{addTitle:function(a){c.push(a)},getLastTitle:function(){return c.slice(-1)[0]}}}();d.ready(function(c){c.initialize(g());
l.debug("Initialized with",g());for(var f=0,d=p().length;f<d;f++)r(p()[f]);c.on("asinChanged",function(c){m("asinChanged",function(){w.addTitle(n(c))})});b.get("useDefaultView")?v.add("play",a.open).add("closed",a.close):l.debug("Custom view requested - defaults not registered")});return{on:v.add,runBeforePlay:function(c){v.add("beforePlay",c)},onCapabilities:k,prepare:function(a){var b=function(b){b.prepare(g(),c(a))};l.debug("prepare called",a);d.ready(function(){m("prepare",b)})},play:function(c){c&&
w.addTitle(n(c));m("beforePlay",function(){q(c)})},stop:function(){l.debug("stop called");m("stop",function(c){c.initialize(g());m("closed")})}}});"use strict";g.register("dv-player-default-view",function(){return{open:function(){document.getElementById("dv-web-player").className="dv-player-fullscreen";document.getElementsByTagName("body")[0].style.overflow="hidden"},close:function(){document.getElementById("dv-web-player").className="";document.getElementsByTagName("body")[0].style.overflow="visible"}}});
"use strict";g.when("dv-player-load-src","dv-player-integration","logging").register("dv-web-player-csm",function(e,d,b){var a,f=b.create("dv-player-src");return function(b){e.ready(function(){f.info("CSM! whenInitialized",b);"function"===typeof h.uex&&h.uex("ld","web-player-src",{wb:1});"function"===typeof h.uet&&h.uet("cf",b,{wb:1})});d.on("pinRequired",function(){f.info("CSM! pinRequired",b);a=!0});d.on("playing",function(){a||(a=!0,f.info("CSM! first-frame",b),"function"===typeof h.uex&&h.uex("ld",
b,{wb:1}))})}});"use strict";g.when("dv-web-player-cfg","dv-player-integration","dv-player-default-view").execute(function(e,d){!e.get("autoplay")&&e.get("videoConfig")&&d.prepare(e.get("videoConfig"))});"use strict";g.when("logging").register("dv-registry",function(e){var d=e.create("dv-registry");return function(){var b={};return{add:function(a,f){if(a&&"function"===typeof f)return d.debug("Updated registry",a,f,b),b[a]=b[a]||[],b[a].push(f),this;d.error("Unable to register fn",a,f)},query:function(a){return b[a]||
[]}}}});"use strict";g.register("promise-polyfill",function(){function e(){}function d(c,a){return function(){c.apply(a,arguments)}}function b(c){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof c)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=u;this._deferreds=[];p(c,this)}function a(c,a){for(;3===c._state;)c=c._value;0===c._state?c._deferreds.push(a):(c._handled=!0,m(function(){var b=1===c._state?a.onFulfilled:
a.onRejected;if(null===b)(1===c._state?f:k)(a.promise,c._value);else{var d;try{d=b(c._value)}catch(e){k(a.promise,e);return}f(a.promise,d)}}))}function f(c,a){try{if(a===c)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"===typeof a||"function"===typeof a)){var f=a.then;if(a instanceof b){c._state=3;c._value=a;g(c);return}if("function"===typeof f){p(d(f,a),c);return}}c._state=1;c._value=a;g(c)}catch(e){k(c,e)}}function k(c,a){c._state=2;c._value=a;g(c)}function g(c){2===
c._state&&0===c._deferreds.length&&m(function(){c._handled||q(c._value)});for(var b=0,f=c._deferreds.length;b<f;b++)a(c,c._deferreds[b]);c._deferreds=null}function t(c,a,b){this.onFulfilled="function"===typeof c?c:null;this.onRejected="function"===typeof a?a:null;this.promise=b}function p(a,b){var d=!1;try{a(function(a){d||(d=!0,f(b,a))},function(a){d||(d=!0,k(b,a))})}catch(e){d||(d=!0,k(b,e))}}if("function"===typeof h.Promise)return h.Promise;var r=setTimeout,m="function"===typeof setImmediate&&
setImmediate||function(a){r(a,0)},q=function(a){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",a)};b.prototype["catch"]=function(a){return this.then(null,a)};b.prototype.then=function(c,b){var f=new this.constructor(e);a(this,new t(c,b,f));return f};b.all=function(a){var f=Array.prototype.slice.call(a);return new b(function(a,c){function b(e,k){try{if(k&&("object"===typeof k||"function"===typeof k)){var g=k.then;if("function"===typeof g){g.call(k,function(a){b(e,
a)},c);return}}f[e]=k;0===--d&&a(f)}catch(h){c(h)}}if(0===f.length)return a([]);for(var d=f.length,e=0;e<f.length;e++)b(e,f[e])})};b.resolve=function(a){return a&&"object"===typeof a&&a.constructor===b?a:new b(function(b){b(a)})};b.reject=function(a){return new b(function(b,f){f(a)})};b.race=function(a){return new b(function(b,f){for(var d=0,e=a.length;d<e;d++)a[d].then(b,f)})};b._setImmediateFn=function(a){m=a};b._setUnhandledRejectionFn=function(a){q=a};return b});g.register("dv-serialize",function(){return function(e){var d=
"",b=0,a;for(a in e)if(e.hasOwnProperty(a))switch(Function.prototype.call(String,null,e[a])){case "[object Array]":for(var f in e[a])e[a].hasOwnProperty(f)&&(d+=(b++?"\x26":"?")+a+"[]\x3d"+encodeURIComponent(e[a][f]));break;case "[object Object]":for(var k in e[a])e[a].hasOwnProperty(k)&&(d+=(b++?"\x26":"?")+a[k]+"\x3d"+encodeURIComponent(e[a][k]));break;default:d+=(b++?"\x26":"?")+a+"\x3d"+encodeURIComponent(e[a])}return d}});g.when("dv-serialize").register("dv-ajax-util",function(e){return function(d){d=
d||{};var b=function(){},a=new XMLHttpRequest,f={url:d.url||!1,method:0<=["POST","GET"].indexOf(d.method)?d.method:"GET",complete:d.complete||b,success:d.success||b,error:d.error||b,data:d.data||{},cache:d.cache?1:0,params:""};a.onreadystatechange=function(){if(4===a.readyState)if(f.complete(a,a.statusText),200===a.status){var b=a.response||a.responseText,d;a:{try{JSON.parse(b)}catch(e){d=!1;break a}d=!0}d&&(b=JSON.parse(b)||b);f.success(b,a.statusText,a)}else f.error(a,a.statusText)};f.data&&(f.params=
e(f.data),"POST"===f.method?(a.open("POST",f.url,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(f.params)):(a.open("GET",f.url+f.params,!0),a.setRequestHeader("x-requested-with","XMLHttpRequest"),a.send()))}});"use strict";g.when("dv-player-load-src").register("dv-web-player-capabilities",function(e){function d(a){e.ready(function(b){b.on("playerCapabilities",a)})}var b;d(function(a){b=a});return function(a){"undefined"!==
typeof b?a(b):d(a)}});g.when("dv-player-integration","dv-ajax-util").execute(function(e,d){function b(a){e.on(a,function(b){if(b){var e={trailer:b.trailer,action:a};"play"!==a&&(e.secondsPlayed=b&&parseInt((new Date).getTime()/1E3)-b.startEpoch);b.asin&&(e.titleId=b.asin);b.lcid&&(e.lcid=b.lcid);d({url:"/gp/video/widgets/main-section/ajax/analytics.html/ref\x3ddv_play_action",data:e})}})}b("play");b("asinChanged");b("closed")});"use strict";g.when("dv-player-integration","promise-polyfill").register("dv-live-incompatable",
function(e,d){return function(b){function a(a){return function(b,d){if("Live"===a.videoType||a.lcid||a.live)e.onCapabilities(f(b,d));else b()}}function f(a,d){return function(e){!1===e.capabilities.supportsLive?(b(),d()):a()}}e.runBeforePlay(function(b){return new d(a(b))})}})});